╭─xulabzz ~/Dev/NLP/ANR/preprocessing ‹master*›
╰─➤  $ python preprocessing_simple.py -d Digital_Music -dev_test_in_train 1                                                                             130 ↵

Dataset: Digital_Music
[args from argparse.ArgumentParser().parse_args()]
command: preprocessing_simple.py -d Digital_Music -dev_test_in_train 1
dataset: Digital_Music
dataset_maximum_size: 1000000
dev_test_in_train: True
maxDL: 500
maxVL: 500
minImages: 1
minReviews: 1
minRL: 10
random_seed: 1337
train_ratio: 0.8
vocab: 50000

[INPUT] Source Folder:       ../datasets/
[INPUT] Reviews/Ratings:     ../datasets/reviews_Digital_Music.json

[OUTPUT] Category Folder:    ../datasets/Digital_Music/
[OUTPUT] env:                ../datasets/Digital_Music/Digital_Music_env.pkl
[OUTPUT] info:               ../datasets/Digital_Music/Digital_Music_info.pkl
[OUTPUT] split_train:        ../datasets/Digital_Music/Digital_Music_train_interactions.pkl
[OUTPUT] split_dev:          ../datasets/Digital_Music/Digital_Music_dev_interactions.pkl
[OUTPUT] split_test:         ../datasets/Digital_Music/Digital_Music_test_interactions.pkl
[OUTPUT] split_train:        ../datasets/Digital_Music/Digital_Music_split_train.pkl
[OUTPUT] split_dev:          ../datasets/Digital_Music/Digital_Music_split_dev.pkl
[OUTPUT] split_test:         ../datasets/Digital_Music/Digital_Music_split_test.pkl
[OUTPUT] uid_userDoc:        ../datasets/Digital_Music/Digital_Music_uid_userDoc.npy
[OUTPUT] iid_itemDoc:        ../datasets/Digital_Music/Digital_Music_iid_itemDoc.npy
[OUTPUT] uid_userDoc:        ../datasets/Digital_Music/Digital_Music_uid_userVis.npy
[OUTPUT] iid_itemDoc:        ../datasets/Digital_Music/Digital_Music_iid_itemVis.npy

Preprocessing data for "Digital_Music"

[Settings]
Min reviews for user/item: 1
Min review length to qualify as an user-item interaction: 10
Max words for user/item document: 500 (For truncating/padding to get a fixed-size representation)
Top-50000 words in vocabulary being utilized!


Initial pass of reviews to get the user-item interactions!
Initial pass of reviews for "Digital_Music": 836006it [00:25, 33311.33it/s]
[Initial stats] Users: 478,235, Items: 266,414, Ratings: 836,006, Density: 0.0000066


Second pass of visual features to get the item-feature interactions!
Initial pass of reviews for "Digital_Music": 100%|█████████████████████████████████████████████████████████████████| 277324/277324 [00:04<00:00, 57710.91it/s]
[Second stats] Items with image: 277,324, Images: 277,324, Density: 1.0000000


Starting to filter away users & items based on thresold of 1 images!
Updating interactions based on the num of images...
Filtering interactions: 100%|████████████████████████████████████████████████████████████████████████████████████| 836006/836006 [00:00<00:00, 3412214.53it/s]

Filtered users & items based on thresold of 1 images!
Users: 478235 -> 475866, Items: 266414 -> 263969
[Current stats] Users: 475866, Items: 263969, Ratings: 830189, Density: 0.0000066
Updating interactions based on the num of images...
Filtering interactions: 100%|████████████████████████████████████████████████████████████████████████████████████| 830189/830189 [00:00<00:00, 3438261.59it/s]

Filtered users & items based on thresold of 1 images!
Users: 475866 -> 475866, Items: 263969 -> 263969
[Current stats] Users: 475866, Items: 263969, Ratings: 830189, Density: 0.0000066

No change in # of users or # of items!

[Final stats] Users: 475,866, Items: 263,969, Ratings: 830,189, Density: 0.0000066

Elapsed time for "Digital_Music": 34.57 seconds (0.58 minutes)

Starting to ilter away users & items based on thresold of 1 reviews!

Filtered users & items based on thresold of 1 reviews!
Users: 475866 -> 475866, Items: 263969 -> 263969

No change in # of users or # of items!

[Final stats] Users: 475,866, Items: 263,969, Ratings: 830,189, Density: 0.0000066

Elapsed time for "Digital_Music": 34.69 seconds (0.58 minutes)


Third pass of reviews to get the rating, date, the num of tokenized review and index!
Third pass of len of reviews for "Digital_Music": 836006it [00:43, 19357.45it/s]
[Current stats] Users: 475,866, Items: 263,969, Ratings: 830,189, Density: 0.0000066

Filtering user-item interactions based on minimum review length of 10 tokens..
Filtering interactions: 100%|████████████████████████████████████████████████████████████████████████████████████| 830189/830189 [00:00<00:00, 4577996.11it/s]

Filtered users & items based on minimum review length of 10 tokens!
Users: 475,866 -> 470,808, Items: 263,969 -> 261,826
[Current stats] Users: 470,808, Items: 261,826, Ratings: 820,822, Density: 0.0000067


Starting to filter away users & items based on thresold of 1 reviews (after removing reviews with <= 10 tokens)!

Filtered users & items based on thresold of 1 reviews!
Users: 470,808 -> 470,808, Items: 261,826 -> 261,826

No change in # of users or # of items!

[Final stats] Users: 470,808, Items: 261,826, Ratings: 820,822, Density: 0.0000067
Fourth pass of reviews for "Digital_Music": 836004it [00:48, 17350.71it/s]


80.0% of ALL reviews are RANDOMLY selected for TRAIN, another 10.0% RANDOMLY selected for DEV, and remaining 10.0% used for TEST.

[Initial Stats] Total Interactions: 820,822, TRAIN: 656,657 (80.00%), DEV: 82,082 (10.00%), TEST: 82,083 (10.00%)


Removing users & items who do not appear in the training set, from the dev and test sets..
Updating DEV interactions: 100%|███████████████████████████████████████████████████████████████████████████████████| 82082/82082 [00:00<00:00, 1025094.20it/s]
Updating TEST interactions: 100%|██████████████████████████████████████████████████████████████████████████████████| 82083/82083 [00:00<00:00, 1054763.26it/s]

Removed 50,618 interactions from DEV and 50,308 interactions from TEST! (i.e. Those belonging to Users/Items which do not appear in TRAIN)

[Current Stats] Total Interactions: 719,896, TRAIN: 656,657 (91.22%), DEV: 31,464 (4.37%), TEST: 31,775 (4.41%)


[FINAL Stats] Users: 397,514, Items: 223,577, Ratings: 719,896, Density: 0.0000081

[FINAL Stats] Total Interactions: 719,896, TRAIN: 656,657 (91.22%), DEV: 31,464 (4.37%), TEST: 31,775 (4.41%)

[FINAL Stats][TRAIN] Users: 397,514, Items: 223,577, Ratings: 656,657
[FINAL Stats][DEV]   Users: 23,933, Items: 17,197, Ratings: 31,464
[FINAL Stats][TEST]  Users: 24,127, Items: 17,301, Ratings: 31,775


train_interactions:   ../datasets/Digital_Music/Digital_Music_train_interactions.pkl
dev_interactions:     ../datasets/Digital_Music/Digital_Music_dev_interactions.pkl
test_interactions:    ../datasets/Digital_Music/Digital_Music_test_interactions.pkl

Consolidating user/item reviews from TRAINING set
Consolidating user/item reviews from TRAINING set: 100%|██████████████████████████████████████████████████████████| 656657/656657 [00:03<00:00, 164771.15it/s]

Creating user docs from TRAINING set
Creating item docs from TRAINING set

Minimum User Doc Len: 10, Minimum Item Doc Len: 10

Original number of words (based on USER & ITEM documents constructed from TRAINING set): 253,890
For the vocabulary, we are only using the 50,000 most frequent words
Current number of words: 50,000

For each user doc, converting words to wids using word_wid...: 100%|███████████████████████████████████████████████| 397514/397514 [00:05<00:00, 76079.37it/s]
For each item doc, converting words to wids using word_wid...: 100%|███████████████████████████████████████████████| 223577/223577 [00:02<00:00, 78493.49it/s]
Store the actual length of each user document (before padding): 100%|████████████████████████████████████████████| 397514/397514 [00:00<00:00, 3361270.89it/s]
Store the actual length of each item document (before padding): 100%|████████████████████████████████████████████| 223577/223577 [00:00<00:00, 3033307.04it/s]
Pad the user documents to MAX_DOC_LEN: 100%|██████████████████████████████████████████████████████████████████████| 397514/397514 [00:02<00:00, 134371.68it/s]
Pad the item documents to MAX_DOC_LEN: 100%|██████████████████████████████████████████████████████████████████████| 223577/223577 [00:01<00:00, 143993.08it/s]
Preparing the TRAINING set: 100%|█████████████████████████████████████████████████████████████████████████████████| 656657/656657 [00:00<00:00, 967229.23it/s]
Preparing the DEV set: 100%|████████████████████████████████████████████████████████████████████████████████████████| 31464/31464 [00:00<00:00, 849843.07it/s]
Preparing the TESTING set: 100%|████████████████████████████████████████████████████████████████████████████████████| 31775/31775 [00:00<00:00, 855280.02it/s]
Info:                 ../datasets/Digital_Music/Digital_Music_info.pkl
Training Set:         ../datasets/Digital_Music/Digital_Music_split_train.pkl
Validation Set:       ../datasets/Digital_Music/Digital_Music_split_dev.pkl
Test Set:             ../datasets/Digital_Music/Digital_Music_split_test.pkl

Creating numpy matrix for uid_userDoc..
User Document Matrix: (397514, 500)
User Document Matrix: ../datasets/Digital_Music/Digital_Music_uid_userDoc.npy

Creating numpy matrix for iid_itemDoc..
Item Document Matrix: (223577, 500)
Item Document Matrix: ../datasets/Digital_Music/Digital_Music_iid_itemDoc.npy

Consolidating user/item visual features from TRAINING set
Consolidating user/item visual features from TRAINING set: 100%|██████████████████████████████████████████████████| 656657/656657 [00:02<00:00, 284411.30it/s]

Creating user visuals from TRAINING set
Creating item visuals from TRAINING set

Minimum User Vis Len: 50, Minimum Item Vis Len: 50
Convert user to uid...: 100%|████████████████████████████████████████████████████████████████████████████████████| 397514/397514 [00:00<00:00, 1804780.97it/s]
Convert item to iid...: 100%|████████████████████████████████████████████████████████████████████████████████████| 223577/223577 [00:00<00:00, 1907903.65it/s]
Store the actual length of each user visual feature (before padding): 100%|██████████████████████████████████████| 397514/397514 [00:00<00:00, 3636355.74it/s]
Store the actual length of each item visual feature (before padding): 100%|██████████████████████████████████████| 223577/223577 [00:00<00:00, 3206530.71it/s]
Pad the user visual feature to MAX_VIS_LEN: 100%|██████████████████████████████████████████████████████████████████| 397514/397514 [00:04<00:00, 84816.75it/s]
Pad the item visual feature to MAX_VIS_LEN: 100%|█████████████████████████████████████████████████████████████████| 223577/223577 [00:01<00:00, 155081.65it/s]

Creating numpy matrix for uid_userVis..
User Visual Feature Matrix: (397514, 500)
User Visual Feature Matrix: ../datasets/Digital_Music/Digital_Music_uid_userDoc.npy

Creating numpy matrix for iid_itemVis..
Item Visual Feature Matrix: (223577, 500)
Item Visual Feature Matrix: ../datasets/Digital_Music/Digital_Music_iid_itemDoc.npy

Saving all required files for "Digital_Music"..
Environment:          ../datasets/Digital_Music/Digital_Music_env.pkl

All required files for "Digital_Music" successfully saved to '../datasets/Digital_Music/'

Preprocessing for "Digital_Music" done after 287.77 seconds (4.80 minutes)


Done!!
f
